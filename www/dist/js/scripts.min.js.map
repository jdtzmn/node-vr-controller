{"version":3,"sources":["js/brim.js","js/gyro.js","js/livereload.js","js/socket.js"],"names":["gajus","brim","platform","view","touched","os","family","parseInt","version","scream","Scream","width","Brim","viewport","on","e","viewName","document","ontouchstart","window","addEventListener","orientation","style","display","getElementsByClassName","preventDefault","innerHTML","getElementById","body","FULLTILT","requestAnimationFrame","client","fulltiltOrientation","motion","then","motionData","console","log","sendOrientation","inVR","obj","beta","alpha","navigator","standalone","innerWidth","innerHeight","userAgent","match","touches","ontouchend","send","livereloadScript","createElement","setAttribute","location","hostname","Image","WebSocket","host","canvas","getContext","context","onmessage","image","event","size","height","onload","data"],"mappings":"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","file":"scripts.min.js","sourcesContent":["var gajus, brim, platform, view, touched\r\n\r\nif (!window.navigator.standalone && platform.os.family === 'iOS' && parseInt(platform.os.version, 10) >= 8) {\r\n  let scream = gajus.Scream({\r\n    width: {\r\n      portrait: 320,\r\n      landscape: 640\r\n    }\r\n  })\r\n\r\n  brim = gajus.Brim({\r\n    viewport: scream\r\n  })\r\n\r\n  brim.on('viewchange', function (e) {\r\n    view = e.viewName\r\n    if (e.viewName === 'minimal') {\r\n      document.ontouchstart = function (e) {\r\n        e.preventDefault()\r\n        touched(e)\r\n      }\r\n    } else {\r\n      document.ontouchstart = function (e) {\r\n        touched(e)\r\n      }\r\n    }\r\n  })\r\n} else if (platform.os.family === 'iOS' && parseInt(platform.os.version, 10) >= 8) {\r\n  window.addEventListener('orientationchange', function () {\r\n    if (window.orientation) {\r\n      view = 'minimal'\r\n      document.getElementsByClassName('cover')[0].style.display = 'none'\r\n    } else {\r\n      document.getElementsByClassName('cover')[0].style.display = 'block'\r\n    }\r\n  }, false)\r\n  document.ontouchstart = function (e) {\r\n    e.preventDefault()\r\n    touched(e)\r\n  }\r\n  document.body.innerHTML = document.getElementById('brim-mask').innerHTML + document.getElementById('brim-main').innerHTML\r\n  if (window.orientation) {\r\n    view = 'minimal'\r\n    document.getElementsByClassName('cover')[0].style.display = 'none'\r\n  }\r\n} else {\r\n  document.body.innerHTML = document.getElementById('brim-main').innerHTML\r\n}\r\n","var FULLTILT, requestAnimationFrame, client, view, fulltiltOrientation, platform\r\n\r\nlet motion = new FULLTILT.getDeviceMotion()\r\nmotion.then((motionData) => {\r\n  fulltiltOrientation = motionData\r\n}).catch((msg) => {\r\n  console.error(msg)\r\n  console.log('Data not available!')\r\n})\r\n\r\nvar sendOrientation = function () {\r\n  if (fulltiltOrientation && inVR()) {\r\n    let motionData = fulltiltOrientation.getScreenAdjustedRotationRate()\r\n    let obj = {}\r\n    obj.alpha = motionData.alpha\r\n    obj.beta = motionData.beta\r\n    obj.gamma = motionData.gamma\r\n    client.send(JSON.stringify(obj))\r\n  }\r\n\r\n  requestAnimationFrame(sendOrientation)\r\n}\r\nsendOrientation()\r\n\r\nvar inVR = function () {\r\n  if (!window.navigator.standalone && platform.os.family === 'iOS' && parseInt(platform.os.version, 10) >= 8 && view === 'minimal' || window.innerWidth > window.innerHeight && (navigator.userAgent.match(/Android/i) || navigator.userAgent.match(/BlackBerry/i) || navigator.userAgent.match(/iemobile/i))) {\r\n    return true\r\n  }\r\n  return false\r\n}\r\n\r\nlet touches = 0\r\nvar touched = function (e) {\r\n  if (client) {\r\n    touches++\r\n  }\r\n}\r\n\r\ndocument.ontouchend = function () {\r\n  if (touches > 3) {\r\n    console.log('invertX')\r\n    client.send('invertX')\r\n  } else if (touches > 2) {\r\n    console.log('recalibrate')\r\n    client.send('recalibrate')\r\n  } else if (touches > 1) {\r\n    client.send('rightClick')\r\n    console.log('rightClick')\r\n  } else if (touches > 0) {\r\n    client.send('mouseClick')\r\n    console.log('mouseClick')\r\n  }\r\n  touches = 0\r\n}\r\n\r\ntouched()\r\n","let livereloadScript = document.createElement('script')\r\nlivereloadScript.setAttribute('src', 'http://' + window.location.hostname + ':35729/livereload.js')\r\nlivereloadScript.setAttribute('charset', 'utf-8')\r\ndocument.body.appendChild(livereloadScript)\r\n","var Image, WebSocket\r\nlet client = new WebSocket('ws://' + window.location.host)\r\nlet canvas = document.getElementById('video')\r\nlet context = canvas.getContext('2d')\r\nclient.onmessage = (event) => {\r\n  if (event.data.size === undefined) {\r\n    let image = new Image()\r\n    image.onload = () => {\r\n      canvas.width = image.width\r\n      canvas.height = image.height\r\n      context.drawImage(image, 0, 0, image.width, image.height)\r\n    }\r\n    image.src = event.data\r\n  }\r\n}\r\n"]}